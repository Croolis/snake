<html>
<meta charset = "utf-8">
<body>
<script src="processing.min.js"></script>

<canvas id="cc" data-processing-sources="anything.pde"></canvas>
<br>
<h3>
    Управление - стрелки <br>
    m - добавить элемент (работает странно, при работе от сервера будет ок) <br>
    n - удалить элемент
</h3>
<script>

    var processingInstance;
        var tabl = [[20, 30], [30, 30], [30, 40], [30, 50], [40, 50], [50, 50], [60, 50], [60, 60], [60, 70], [60, 80]];
    setTimeout( function() {
        processingInstance= Processing.getInstanceById('cc');
        processingInstance.ini(10);
    }, 1000);

function aa(xx, yy) {
    for(var i = 0; i<tabl.length-1; i++) {
        tabl[i][0] = tabl[i+1][0];
        tabl[i][1] = tabl[i+1][1];
    }
    tabl[tabl.length-1][0]+=xx;
    tabl[tabl.length-1][1]+=yy;
}

function addBlock() {
    tabl.push([0,0]);
}

function delBlock() {
    tabl.pop();
}
    
addEventListener("keydown", function(event) {

    if(event.keyCode>=37 && event.keyCode<=40) {
        if(event.keyCode == 37) {
            aa(-10, 0);
        } else if(event.keyCode == 38) {
            aa(0, -10);
        } else if(event.keyCode == 39) {
            aa(10, 0);
        } else if(event.keyCode == 40) {
            aa(0, 10);
        }
        processingInstance.setCoords(tabl.length, tabl);
    } else if (event.keyCode == 77){ // 'm'
        addBlock();
    } else {
        delBlock();
    }
    //if (event.keyCode == 86)
      //document.body.style.background = "violet";
  });
</script>
</body>
</html>
